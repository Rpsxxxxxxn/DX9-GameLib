//********************************************************************************
//
// LockOn.hpp
//
// ロックオンカメラ
//
// Date: 2019/07/30 更新
//
//********************************************************************************

#pragma once

//================================================================================
// インクルード
//================================================================================
#include "../../GameManager/GameManager.h"
#include "../AI/AIManager.hpp"
#include "../Player/Player.hpp"

//================================================================================
// クラス定義
//================================================================================
class CLockOnSystem : public CGameObject
{
public:

	//--------------------------------------------------------------------------------
	// コンストラクタ
	//--------------------------------------------------------------------------------
	CLockOnSystem();

	//--------------------------------------------------------------------------------
	// デストラクタ
	//--------------------------------------------------------------------------------
	~CLockOnSystem();

	//--------------------------------------------------------------------------------
	// ファイル読み込み
	// 引　数：CSystem*	システムクラスのポインタ
	//--------------------------------------------------------------------------------
	void LoadFile(CSystem* pSystem);

	//--------------------------------------------------------------------------------
	// 初期化
	// 引　数：CSystem*	システムクラスのポインタ
	//--------------------------------------------------------------------------------
	void Initialize(CSystem* pSystem);

	//--------------------------------------------------------------------------------
	// 更新
	// 引　数：CSystem*	システムクラスのポインタ
	// 　　　　CPlayer*	プレイヤークラスのポインタ
	//--------------------------------------------------------------------------------
	void Update(CSystem* pSystem, CPlayer* pPlayer, CAIManager* pAI);

	//--------------------------------------------------------------------------------
	// 描画
	// 引　数：CSystem*	システムクラスのポインタ
	//--------------------------------------------------------------------------------
	void Draw(CSystem* pSystem, CCamera* pCamera);

	//--------------------------------------------------------------------------------
	// ロックオン方向の取得
	// 戻り値：const float	方向
	//--------------------------------------------------------------------------------
	float GetAngle() const { return m_angle; };

private:

	//--------------------------------------------------------------------------------
	// 敵とプレイヤーの距離計算
	// 引　数：CPlayer*		プレイヤークラスのポインタ
	// 　　　　CAIManager*	敵管理クラスのポインタ
	//--------------------------------------------------------------------------------
	void CalcAIAndPlayerDistance(CPlayer * pPlayer, CAIManager* pAI);

	//--------------------------------------------------------------------------------
	// ロックオン方向の計算
	//--------------------------------------------------------------------------------
	void CalcLockDirection();

	LPDIRECT3DTEXTURE9 m_pTexture;
	Vector3 m_vecPosDelay;
	Vector3 m_vecPlayer;
	float m_distance;
	float m_angle;
	float m_size;

	bool m_isLockOn;
};