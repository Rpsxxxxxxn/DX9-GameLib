//*************************************************************
//
// SceneObjectManager.h
//
// シーンオブジェクト管理
//
// Date: 2019/07/30 更新
//
//*************************************************************

#pragma once

//=============================================================
// マクロ定義
//=============================================================
#define SCENE_CHANGE(scene) CSceneManager::GetInstance()->SetScene(scene)
#define CONSTANT_TABLE(cam) CSceneManager::GetInstance()->SetConstantTable(cam)

//=============================================================
// インクルード
//=============================================================
#include "GameManager/GameManager.h"
#include "ShareObject/ShareObject.h"

//=============================================================
// シーン列挙体
//=============================================================
enum Scene
{
	SCENE_TITLE,
	SCENE_GAME,
	SCENE_RESULT,
	SCENE_EXIT,
};

//=============================================================
// 前方宣言
//=============================================================
class IScene;

//=============================================================
// クラス定義
//=============================================================
class CSceneManager
{
public:

	//-------------------------------------------------------------
	// 初期化
	//-------------------------------------------------------------
	void Initialize(CSystem* pSystem);

	//-------------------------------------------------------------
	// 更新
	//-------------------------------------------------------------
	void Update();

	//-------------------------------------------------------------
	// 描画
	//-------------------------------------------------------------
	void Draw();

	//-------------------------------------------------------------
	// シーンの設定
	// 引　数：const Scene	次のシーンタイプ
	//-------------------------------------------------------------
	void SetScene(const Scene type);

	//-------------------------------------------------------------
	// シーン変更
	//-------------------------------------------------------------
	bool ChangeScene();

	//-------------------------------------------------------------
	// 分割シャドウの値設定
	// 引　数：CCamera*			カメラクラスのポインタ
	//-------------------------------------------------------------
	void SetConstantTable(CCamera* pCamera);

	//-------------------------------------------------------------
	// 共有するデータ
	//-------------------------------------------------------------
	static ShareObject shareData;

	//-------------------------------------------------------------
	// インスタンスの取得
	//-------------------------------------------------------------
	static CSceneManager* GetInstance();

	//-------------------------------------------------------------
	// 生成
	//-------------------------------------------------------------
	static void Create();

	//-------------------------------------------------------------
	// 破棄
	//-------------------------------------------------------------
	static void Destroy();

private:

	//-------------------------------------------------------------
	// コンストラクタ
	//-------------------------------------------------------------
	CSceneManager();

	//-------------------------------------------------------------
	// デストラクタ
	//-------------------------------------------------------------
	~CSceneManager();

	//シングルトン生成
	static CSceneManager* m_pInstance;

	//シーン状態
	Scene m_nowScene;
	Scene m_newScene;

	//シーンオブジェクト
	IScene* m_pNowScene;

	//システムのポインタ
	CSystem* m_pSystem;

	//シャドウ用
	CDirectionLight*	m_pLight;
	LPDIRECT3DTEXTURE9	m_pShadowMap[3];
	Matrix*				m_pMatVP;
};