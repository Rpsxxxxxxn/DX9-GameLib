//*************************************************************
//
// Se.hpp
//
// Seファイル読み込み用クラス
//
// Date: 2019/07/30 更新
//
//*************************************************************

#pragma once

//=============================================================
// インクルード
//=============================================================
#include "../../../Common.h"

//=============================================================
// クラス定義
//=============================================================
class CSe
{
public:
	//-------------------------------------------------------------
	// コンストラクタ
	// 引　数：IXAudio2*	オーディオインターフェース
	// 　　　　string		ファイルパス
	//-------------------------------------------------------------
	CSe(IXAudio2* pXAudio, string name);

	//-------------------------------------------------------------
	// デストラクタ
	//-------------------------------------------------------------
	~CSe();

	//-------------------------------------------------------------
	// 初期化
	// 引　数：string	ファイルディレクトリ
	//-------------------------------------------------------------
	void Initialize(string name);

	//-------------------------------------------------------------
	// 更新
	//-------------------------------------------------------------
	void Update();

	//-------------------------------------------------------------
	// 開放
	//-------------------------------------------------------------
	void Release();

	//-------------------------------------------------------------
	// 再生
	//-------------------------------------------------------------
	void Play();

	//-------------------------------------------------------------
	// ボリュームの設定
	// 引　数：float	音の大きさ
	//-------------------------------------------------------------
	void SetVolume(float volume);

	//-------------------------------------------------------------
	// ボリュームの取得
	// 戻り値：float	現在の大きさ
	//-------------------------------------------------------------
	float GetVolume();

	//-------------------------------------------------------------
	// Seの追加1
	//-------------------------------------------------------------
	void AddSe();

private:

	//-------------------------------------------------------------
	// バッファの生成
	// 引　数：const int バッファカウント
	// 　　　：const int バッファの長さ
	//-------------------------------------------------------------
	void CreateBuffer(const int bufferLen);

	//-------------------------------------------------------------
	// ファイル読み込み
	//-------------------------------------------------------------
	void ReadFile(string name);

	IXAudio2* m_pXAudio2;
	vector<IXAudio2SourceVoice*> m_vecSour;
	XAUDIO2_BUFFER m_pBuffer;
	WAVEFORMATEX m_fmt;
	BYTE* m_pBuf;
	HMMIO m_mmio;
	int m_pData;
	int bufCnt;
	float m_volume;
};