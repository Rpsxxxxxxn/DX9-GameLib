//*************************************************************
//
// Billboard.hpp
//
// メッシュ生成(常にこちらを向いている)
//
// Date: 2019/10/14 更新
//
//*************************************************************

//=============================================================
// インクルード
//=============================================================
#include "../../Common.h"
#include "../../System/System.h"

//=============================================================
// 構造体定義
//=============================================================
struct Vertex3D
{
	Vector3 vtx;
	Vector3 nor;
	D3DCOLOR dif;
	Vector2 tex;
};

//=============================================================
// ビルボード設定の種類
//=============================================================
enum BillboardType
{
	BILL_CE,
	BILL_LU,
	BILL_CEG,
};

//=============================================================
// クラス定義
//=============================================================
class CBillboard
{
public:

	//-------------------------------------------------------------
	// コンストラクタ
	//-------------------------------------------------------------
	CBillboard();

	//-------------------------------------------------------------
	// デストラクタ
	//-------------------------------------------------------------
	~CBillboard();

	//-------------------------------------------------------------
	// 初期化
	// 引　数：CSystem*				デバイスのポインタ
	// 　　　　LPDIRECT3DTEXTURE9	テクスチャのポインタ
	// 　　　　BillboardType		ビルボード頂点生成の種類
	//-------------------------------------------------------------
	void Initialize(CSystem* pSystem, LPDIRECT3DTEXTURE9 pTexture, BillboardType type);

	//-------------------------------------------------------------
	// 描画
	// 引　数：LPDIRECT3DDEVICE9	デバイスのポインタ
	// 　　　　Matrix*				ビューの逆行列
	//-------------------------------------------------------------
	void Draw(CSystem* pSystem, Matrix* pInvView);

	//-------------------------------------------------------------
	// 色の設定
	// 引　数：D3DXCOLOR	RGBA色
	//-------------------------------------------------------------
	void SetColor(const D3DXCOLOR color);

	//-------------------------------------------------------------
	// 位置ベクトルの設定
	// 引　数：Vector3*		位置ベクトルのポインタ
	//-------------------------------------------------------------
	void SetPosition(const Vector3* vecPos);

	//-------------------------------------------------------------
	// 拡大ベクトルの設定
	// 引　数：Vector3*		拡大ベクトルのポインタ
	//-------------------------------------------------------------
	void SetSize(const Vector2* vecSize);

	//-------------------------------------------------------------
	// 進行状況の設定
	// 引　数：float		パーセント
	//-------------------------------------------------------------
	void SetProgress(const float gauge);
private:

	//-------------------------------------------------------------
	// 更新
	//-------------------------------------------------------------
	void Update(Matrix* pInvView);

	//-------------------------------------------------------------
	// ビルボード(中央生成)
	//-------------------------------------------------------------
	void GenerateVertexCE();

	//-------------------------------------------------------------
	// ビルボード(左上生成)
	//-------------------------------------------------------------
	void GenerateVertexLU();

	//-------------------------------------------------------------
	// ビルボード(中央生成ゲージ用)
	//-------------------------------------------------------------
	void GenerateVertexCEG();

	LPDIRECT3DVERTEXBUFFER9 m_pVB;
	LPDIRECT3DTEXTURE9 m_pTexture;
	BillboardType m_type;
	D3DXCOLOR m_color;
	Vector2 m_vecSize;
	Vector3 m_vecPos;
	Matrix m_matWorld;

	float m_sizeX;
};