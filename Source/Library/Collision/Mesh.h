//*************************************************************
//
// Mesh.h
//
// 当たり判定クラス(メッシュ)
//
// Date: 2019/07/30 更新
//
//*************************************************************

#pragma once

//=============================================================
// インクルード
//=============================================================
#include "../System/FileLoader/XFile/XFile.h"

//=============================================================
// メッシュデータ
//=============================================================
struct Mesh_Data
{
	Vector3 vVertex[3];
	Vector3 vNormal;
	DWORD dwAdjacency[3];
	bool bChecked;
};

//=============================================================
// クラス定義
//=============================================================
class CMesh
{
public:
	//-------------------------------------------------------------
	// コンストラクタ
	//-------------------------------------------------------------
	CMesh();

	//-------------------------------------------------------------
	// デストラクタ
	//-------------------------------------------------------------
	~CMesh();

	//-------------------------------------------------------------
	// 初期化
	// 引　数：CXFile*	読み込んだXFileのメッシュ
	//-------------------------------------------------------------
	void Create(CXFile* pMesh);

	//-------------------------------------------------------------
	// 確認フラグを初期化
	//-------------------------------------------------------------
	void ClearCheckFlg();

	//-------------------------------------------------------------
	// メッシュ取得
	// 戻り値：CXFile*	当たり判定クラスが持っているメッシュポインタ
	//-------------------------------------------------------------
	CXFile* GetMesh() { return m_pMesh; };

	//-------------------------------------------------------------
	// メッシュデータ取得(判定用)
	// 戻り値：Mesh_Data*	読み込んだXFileのメッシュデータ
	//-------------------------------------------------------------
	Mesh_Data* GetMeshData() { return m_pMeshData; };

	//-------------------------------------------------------------
	// ポリゴン数取得
	// 戻り値：DWORD	ポリゴン数
	//-------------------------------------------------------------
	DWORD GetNumFaces() { return m_numFaces; };

private:

	//-------------------------------------------------------------
	// ポリゴンの法線計算
	// 引　数：Vector3	頂点ベクトル
	//-------------------------------------------------------------
	Vector3 ComputeNormals(const Vector3 vtx[3]);

	CXFile* m_pMesh;
	Mesh_Data* m_pMeshData;
	DWORD m_numFaces;
};